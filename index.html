<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exclusive User Storage App</title>

<style>
body {
    margin: 0;
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    color: white;
}

.container {
    background: rgba(255,255,255,0.08);
    backdrop-filter: blur(15px);
    padding: 30px;
    border-radius: 15px;
    width: 380px;
    box-shadow: 0 15px 35px rgba(0,0,0,0.5);
}

h2 {
    text-align: center;
    margin-bottom: 10px;
}

.datetime {
    text-align: center;
    font-size: 14px;
    margin-bottom: 20px;
    opacity: 0.8;
}

input {
    width: 100%;
    padding: 10px;
    margin: 8px 0;
    border-radius: 8px;
    border: none;
    outline: none;
}

button {
    width: 100%;
    padding: 10px;
    margin-top: 10px;
    border: none;
    border-radius: 8px;
    background: #00c6ff;
    background: linear-gradient(to right, #0072ff, #00c6ff);
    color: white;
    font-weight: bold;
    cursor: pointer;
    transition: 0.3s;
}

button:hover {
    transform: scale(1.03);
}

.toggle {
    text-align: center;
    margin-top: 15px;
    cursor: pointer;
    color: #00c6ff;
}

.dashboard {
    display: none;
}

.user-list {
    margin-top: 15px;
    font-size: 14px;
    max-height: 100px;
    overflow-y: auto;
}

.logout-btn {
    background: linear-gradient(to right, #ff416c, #ff4b2b);
}
</style>
</head>
<body>

<div class="container">
    <div class="datetime" id="datetime"></div>

    <div id="authSection">
        <h2 id="formTitle">Login</h2>
        <input type="text" id="username" placeholder="Username">
        <input type="password" id="password" placeholder="Password">
        <button onclick="handleAuth()">Login</button>
        <div class="toggle" onclick="toggleForm()">Belum punya akun? Register</div>
    </div>

    <div id="dashboard" class="dashboard">
        <h2>Dashboard</h2>
        <p>Login sebagai: <b id="currentUser"></b></p>
        <button class="logout-btn" onclick="logout()">Logout</button>
        <div class="user-list">
            <h4>User Terdaftar:</h4>
            <ul id="userList"></ul>
        </div>
    </div>
</div>

<script>
let isLogin = true;

// Realtime Date & Time
function updateDateTime() {
    const now = new Date();
    const options = { 
        weekday: 'long', year: 'numeric', month: 'long', 
        day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit' 
    };
    document.getElementById("datetime").innerText = now.toLocaleDateString('id-ID', options);
}
setInterval(updateDateTime, 1000);
updateDateTime();

function toggleForm() {
    isLogin = !isLogin;
    document.getElementById("formTitle").innerText = isLogin ? "Login" : "Register";
    document.querySelector("button").innerText = isLogin ? "Login" : "Register";
    document.querySelector(".toggle").innerText = isLogin 
        ? "Belum punya akun? Register" 
        : "Sudah punya akun? Login";
}

async function hashPassword(password) {
    const encoder = new TextEncoder();
    const data = encoder.encode(password);
    const hash = await crypto.subtle.digest("SHA-256", data);
    return Array.from(new Uint8Array(hash))
        .map(b => b.toString(16).padStart(2, "0"))
        .join("");
}

async function handleAuth() {
    const username = document.getElementById("username").value.trim();
    const password = document.getElementById("password").value.trim();

    if (!username || !password) {
        alert("Username dan password wajib diisi!");
        return;
    }

    const users = JSON.parse(localStorage.getItem("users")) || [];
    const hashedPassword = await hashPassword(password);

    if (isLogin) {
        const user = users.find(u => u.username === username && u.password === hashedPassword);
        if (user) {
            localStorage.setItem("currentUser", username);
            showDashboard();
        } else {
            alert("Login gagal! Username atau password salah.");
        }
    } else {
        const exists = users.find(u => u.username === username);
        if (exists) {
            alert("Username sudah digunakan!");
            return;
        }
        users.push({ username, password: hashedPassword });
        localStorage.setItem("users", JSON.stringify(users));
        alert("Registrasi berhasil! Silakan login.");
        toggleForm();
    }
}

function showDashboard() {
    document.getElementById("authSection").style.display = "none";
    document.getElementById("dashboard").style.display = "block";
    document.getElementById("currentUser").innerText = localStorage.getItem("currentUser");
    renderUsers();
}

function logout() {
    localStorage.removeItem("currentUser");
    location.reload();
}

function renderUsers() {
    const users = JSON.parse(localStorage.getItem("users")) || [];
    const list = document.getElementById("userList");
    list.innerHTML = "";
    users.forEach(user => {
        const li = document.createElement("li");
        li.textContent = user.username;
        list.appendChild(li);
    });
}

if (localStorage.getItem("currentUser")) {
    showDashboard();
}
</script>

</body>
</html>

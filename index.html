<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyVault Pro - Cyber Security</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap');
        
        :root {
            --accent: #a855f7; /* Purple */
            --secondary: #06b6d4; /* Cyan */
            --bg: #030014;
        }

        body { 
            background-color: var(--bg); 
            color: #e2e8f0; 
            font-family: 'Space Grotesk', sans-serif; 
            transition: all 0.5s ease;
            user-select: none;
            overflow-x: hidden;
        }

        /* Glassmorphism Effect */
        .glass { 
            background: rgba(255, 255, 255, 0.02); 
            border: 1px solid rgba(255, 255, 255, 0.05); 
            backdrop-filter: blur(15px); 
        }

        /* PIN Dots */
        .pin-dot { 
            width: 16px; height: 16px; border-radius: 50%; 
            border: 2px solid #1e1b4b; background: transparent;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1); 
        }
        .pin-dot.active { 
            background-color: var(--secondary) !important; 
            border-color: var(--secondary) !important; 
            box-shadow: 0 0 15px var(--secondary); 
            transform: scale(1.3);
        }

        /* Keypad Buttons */
        .key-btn {
            height: 75px; width: 100%; border-radius: 1.25rem;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.05);
            font-size: 1.5rem; font-weight: 700;
            display: flex; align-items: center; justify-content: center;
            transition: 0.2s; cursor: pointer;
        }
        .key-btn:hover { background: rgba(255, 255, 255, 0.08); border-color: var(--accent); }
        .key-btn:active { transform: scale(0.9); background: var(--secondary); color: black; }

        /* Animation */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade { animation: fadeIn 0.4s ease-out forwards; }
        
        .glow-bg {
            position: fixed; width: 600px; height: 600px;
            border-radius: 50%; filter: blur(120px); z-index: -1; opacity: 0.15;
            pointer-events: none;
        }
    </style>
</head>
<body class="overflow-x-hidden">

    <!-- Efek Cahaya Latar -->
    <div class="glow-bg top-[-10%] left-[-10%]" style="background: var(--accent);"></div>
    <div class="glow-bg bottom-[-10%] right-[-10%]" style="background: var(--secondary);"></div>

    <div id="app">
        <!-- 1. HALAMAN LOGIN -->
        <section id="login-screen" class="min-h-screen flex flex-col items-center justify-center p-6 text-center animate-fade">
            <div class="mb-8 p-6 rounded-[2.5rem] glass shadow-2xl relative">
                <i data-lucide="lock" class="w-14 h-14 text-cyan-400"></i>
                <div class="absolute inset-0 bg-cyan-400/20 blur-2xl -z-10 rounded-full"></div>
            </div>
            
            <h1 class="text-4xl font-bold mb-2 tracking-tighter text-white">MYVAULT <span class="text-cyan-400">PRO</span></h1>
            <p class="text-slate-500 mb-10 text-xs font-bold uppercase tracking-[0.3em]">Masukkan PIN Akses</p>

            <div class="flex gap-5 mb-12" id="pin-container">
                <div class="pin-dot"></div><div class="pin-dot"></div>
                <div class="pin-dot"></div><div class="pin-dot"></div>
            </div>

            <div class="grid grid-cols-3 gap-4 w-full max-w-[320px]">
                <!-- Tombol angka akan dipasang listener lewat JS -->
                <button class="key-btn" data-n="1">1</button>
                <button class="key-btn" data-n="2">2</button>
                <button class="key-btn" data-n="3">3</button>
                <button class="key-btn" data-n="4">4</button>
                <button class="key-btn" data-n="5">5</button>
                <button class="key-btn" data-n="6">6</button>
                <button class="key-btn" data-n="7">7</button>
                <button class="key-btn" data-n="8">8</button>
                <button class="key-btn" data-n="9">9</button>
                <button id="btn-bio" class="key-btn opacity-30"><i data-lucide="fingerprint"></i></button>
                <button class="key-btn" data-n="0">0</button>
                <button id="btn-del" class="key-btn opacity-30"><i data-lucide="delete"></i></button>
            </div>
        </section>

        <!-- 2. HALAMAN UTAMA -->
        <section id="main-screen" class="hidden min-h-screen flex flex-col animate-fade">
            <header class="p-5 border-b border-white/5 glass sticky top-0 z-30 flex justify-between items-center px-8">
                <div class="flex items-center gap-3">
                    <div class="p-2 rounded-xl bg-cyan-500 text-black shadow-lg shadow-cyan-500/20"><i data-lucide="shield" class="w-5 h-5"></i></div>
                    <span class="font-bold text-xl text-white tracking-tighter uppercase">MyVault</span>
                </div>
                <div class="flex items-center gap-2">
                    <button id="btn-lock" class="p-3 bg-red-500/10 rounded-2xl text-red-400 hover:bg-red-500 hover:text-white transition-all"><i data-lucide="power" class="w-5 h-5"></i></button>
                </div>
            </header>

            <main class="p-6 max-w-6xl mx-auto w-full">
                <div class="relative mb-10 group">
                    <i data-lucide="search" class="absolute left-6 top-1/2 -translate-y-1/2 text-slate-500 w-5 h-5"></i>
                    <input id="search-bar" type="text" placeholder="Cari rahasia..." class="w-full bg-white/5 border border-white/10 py-5 pl-16 pr-8 rounded-[2rem] outline-none focus:border-cyan-500/30 transition-all font-medium">
                </div>

                <div class="flex justify-between items-center mb-8">
                    <h2 class="text-2xl font-bold text-white tracking-tight uppercase italic">Database Rahasia</h2>
                    <p id="item-count" class="text-[10px] font-bold text-slate-500 uppercase tracking-widest bg-white/5 px-3 py-1 rounded-full">0 ITEM</p>
                </div>

                <div id="vault-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
                
                <div id="empty-state" class="hidden py-32 text-center opacity-20">
                    <i data-lucide="database" class="mx-auto w-16 h-16 mb-4"></i>
                    <p class="font-bold uppercase tracking-[0.4em] text-xs">Belum ada data</p>
                </div>
            </main>

            <button id="btn-add" class="fixed bottom-10 right-10 px-8 py-5 bg-cyan-500 text-black font-black rounded-[2rem] shadow-2xl hover:scale-105 active:scale-95 transition-all flex items-center gap-3 z-40 text-sm shadow-cyan-500/30">
                <i data-lucide="plus" class="w-6 h-6"></i> TAMBAH BARU
            </button>
        </section>
    </div>

    <!-- 3. MODAL TAMBAH DATA -->
    <div id="modal-add" class="fixed inset-0 bg-black/90 backdrop-blur-xl hidden z-50 p-6 flex items-center justify-center animate-fade">
        <div class="bg-[#080810] w-full max-w-lg rounded-[3rem] border border-white/10 p-10 space-y-6 shadow-2xl relative">
            <h3 class="text-2xl font-bold text-white uppercase tracking-tighter">SIMPAN RAHASIA</h3>
            
            <div class="space-y-4">
                <div class="relative">
                    <input id="in-name" type="text" placeholder="Nama Layanan (Contoh: Gmail)" class="w-full bg-white/5 border border-white/10 p-5 rounded-2xl outline-none focus:border-cyan-500/30 text-white font-bold">
                    <button id="ai-smart" class="absolute right-4 top-1/2 -translate-y-1/2 text-[10px] bg-cyan-500/20 text-cyan-400 px-3 py-1.5 rounded-xl border border-cyan-500/30 font-bold">✨ AI AUTO</button>
                </div>
                <input id="in-user" type="text" placeholder="Username / ID" class="w-full bg-white/5 border border-white/10 p-5 rounded-2xl outline-none text-white">
                <input id="in-pass" type="text" placeholder="Password" class="w-full bg-white/5 border border-white/10 p-5 rounded-2xl outline-none text-white font-mono tracking-widest">
                
                <div id="file-drop" class="w-full aspect-video rounded-[2rem] border-2 border-dashed border-white/10 flex flex-col items-center justify-center bg-white/[0.02] cursor-pointer relative overflow-hidden group">
                    <img id="prev-img" class="hidden absolute inset-0 w-full h-full object-cover opacity-40">
                    <div id="drop-hint" class="text-center"><i data-lucide="camera" class="mx-auto mb-2 text-slate-600 group-hover:text-cyan-400 transition-colors"></i><p class="text-[10px] text-slate-600 font-bold uppercase tracking-widest">Unggah Lampiran</p></div>
                </div>
                <input id="in-file" type="file" accept="image/*" class="hidden">
            </div>

            <div class="flex gap-4 pt-4">
                <button id="btn-cancel" class="flex-1 py-4 text-slate-500 font-bold uppercase text-xs tracking-widest">Batal</button>
                <button id="btn-save" class="flex-[2] py-4 bg-cyan-500 text-black font-black rounded-2xl uppercase text-xs tracking-widest shadow-lg shadow-cyan-500/20">Simpan Aman</button>
            </div>
        </div>
    </div>

    <!-- 4. MODAL DETAIL -->
    <div id="modal-detail" class="fixed inset-0 bg-black/98 backdrop-blur-2xl hidden z-[60] p-6 flex items-center justify-center">
        <div id="detail-box" class="bg-[#080810] w-full max-w-xl rounded-[3.5rem] border border-white/10 p-12 space-y-8 shadow-2xl relative max-h-[90vh] overflow-y-auto no-scrollbar">
            <!-- Isi detail via JS -->
        </div>
    </div>

    <script>
        // --- KONFIGURASI API (Wajib diisi di GitHub agar AI jalan) ---
        const apiKey = ""; 

        const state = {
            currentPin: "",
            masterPin: "1234",
            data: JSON.parse(localStorage.getItem('vault_v3_data') || "[]"),
            tempImg: ""
        };

        // --- FUNGSI CORE ---
        
        async function askAI(prompt) {
            if(!apiKey) return "API Key Belum Diisi.";
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            try {
                const res = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });
                const json = await res.json();
                return json.candidates[0].content.parts[0].text;
            } catch(e) { return "Gagal menghubungi AI."; }
        }

        const updateDots = () => {
            const dots = document.querySelectorAll('.pin-dot');
            dots.forEach((dot, i) => dot.classList.toggle('active', i < state.currentPin.length));
        };

        const unlock = () => {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('main-screen').classList.remove('hidden');
            renderList();
            lucide.createIcons();
        };

        const renderList = () => {
            const list = document.getElementById('vault-list');
            const search = document.getElementById('search-bar').value.toLowerCase();
            const filtered = state.data.filter(i => i.name.toLowerCase().includes(search));

            document.getElementById('item-count').textContent = `${filtered.length} ITEM`;
            document.getElementById('empty-state').classList.toggle('hidden', filtered.length > 0);

            list.innerHTML = filtered.map(item => `
                <div class="glass p-7 rounded-[2.5rem] border border-white/5 hover:border-cyan-500/40 transition-all cursor-pointer group animate-fade" data-id="${item.id}">
                    <div class="flex justify-between items-start mb-6 pointer-events-none">
                        <div class="w-14 h-14 rounded-2xl bg-cyan-500 text-black flex items-center justify-center font-black text-2xl shadow-lg">${item.name[0].toUpperCase()}</div>
                        <i data-lucide="arrow-up-right" class="w-5 h-5 text-slate-700 group-hover:text-cyan-400 transition-colors"></i>
                    </div>
                    <h4 class="font-bold text-xl text-white mb-1 pointer-events-none">${item.name}</h4>
                    <div class="bg-black/40 rounded-xl p-3 border border-white/5 font-mono text-cyan-500 text-xs tracking-[0.5em] text-center pointer-events-none uppercase">••••••••</div>
                </div>
            `).join('');

            // Pasang Click ke Kartu
            list.querySelectorAll('.glass').forEach(card => {
                card.onclick = () => openDetail(card.getAttribute('data-id'));
            });
            lucide.createIcons();
        };

        const openDetail = (id) => {
            const item = state.data.find(i => i.id == id);
            if(!item) return;
            const modal = document.getElementById('modal-detail');
            const box = document.getElementById('detail-box');
            
            box.innerHTML = `
                <button id="det-close" class="absolute top-8 right-8 text-slate-500 hover:text-white"><i data-lucide="x"></i></button>
                <div class="flex items-center gap-6 mb-10">
                    <div class="w-20 h-20 rounded-[1.5rem] bg-cyan-500 text-black flex items-center justify-center font-black text-4xl">${item.name[0].toUpperCase()}</div>
                    <div>
                        <h2 class="text-4xl font-black text-white uppercase tracking-tighter">${item.name}</h2>
                        <p class="text-cyan-500 text-[10px] font-bold uppercase tracking-widest">Terenkripsi • ${item.date}</p>
                    </div>
                </div>
                <div class="space-y-4">
                    <div class="p-6 bg-white/5 rounded-[1.5rem] border border-white/5"><p class="text-[10px] font-bold text-slate-600 uppercase mb-1">User ID</p><p class="text-white font-bold text-lg">${item.user || '-'}</p></div>
                    <div class="p-6 bg-white/5 rounded-[1.5rem] border border-white/5"><p class="text-[10px] font-bold text-slate-600 uppercase mb-1">Passphrase</p><p class="text-3xl font-mono text-cyan-400 font-black tracking-widest">${item.pass}</p></div>
                    ${item.file ? `<img src="${item.file}" class="w-full rounded-[2rem] border border-white/10 shadow-2xl mt-4">` : ''}
                </div>
                <div class="pt-8">
                    <button id="det-del" class="w-full py-5 bg-red-500/10 text-red-500 rounded-2xl font-black text-xs uppercase tracking-widest hover:bg-red-500 hover:text-white transition-all">Hapus Permanen</button>
                </div>
            `;
            
            modal.classList.remove('hidden');
            lucide.createIcons();

            document.getElementById('det-close').onclick = () => modal.classList.add('hidden');
            document.getElementById('det-del').onclick = () => {
                if(confirm("Hapus rahasia ini?")) {
                    state.data = state.data.filter(i => i.id != id);
                    localStorage.setItem('vault_v3_data', JSON.stringify(state.data));
                    modal.classList.add('hidden');
                    renderList();
                }
            };
        };

        // --- INISIALISASI EVENT LISTENERS (SOLUSI GITHUB) ---
        
        document.addEventListener('DOMContentLoaded', () => {
            // 1. PIN Keypad
            document.querySelectorAll('[data-n]').forEach(btn => {
                btn.addEventListener('click', () => {
                    const val = btn.getAttribute('data-n');
                    if(state.currentPin.length < 4) {
                        state.currentPin += val;
                        updateDots();
                        if(state.currentPin === state.masterPin) setTimeout(unlock, 200);
                        else if(state.currentPin.length === 4) {
                            setTimeout(() => { alert("PIN SALAH!"); state.currentPin = ""; updateDots(); }, 200);
                        }
                    }
                });
            });

            // 2. Kontrol Dasar
            document.getElementById('btn-del').onclick = () => { state.currentPin = ""; updateDots(); };
            document.getElementById('btn-bio').onclick = () => unlock();
            document.getElementById('btn-lock').onclick = () => location.reload();
            document.getElementById('search-bar').oninput = renderList;

            // 3. Modal Tambah
            const addMod = document.getElementById('modal-add');
            document.getElementById('btn-add').onclick = () => addMod.classList.remove('hidden');
            document.getElementById('btn-cancel').onclick = () => {
                addMod.classList.add('hidden');
                state.tempImg = "";
                document.getElementById('prev-img').classList.add('hidden');
                document.getElementById('drop-hint').classList.remove('hidden');
            };

            // 4. File Upload
            document.getElementById('file-drop').onclick = () => document.getElementById('in-file').click();
            document.getElementById('in-file').onchange = (e) => {
                const file = e.target.files[0];
                if(file) {
                    const reader = new FileReader();
                    reader.onloadend = () => {
                        state.tempImg = reader.result;
                        const img = document.getElementById('prev-img');
                        img.src = reader.result;
                        img.classList.remove('hidden');
                        document.getElementById('drop-hint').classList.add('hidden');
                    };
                    reader.readAsDataURL(file);
                }
            };

            // 5. Simpan Data
            document.getElementById('btn-save').onclick = () => {
                const name = document.getElementById('in-name').value;
                const user = document.getElementById('in-user').value;
                const pass = document.getElementById('in-pass').value;

                if(!name || !pass) return alert("Lengkapi data!");

                const newItem = {
                    id: Date.now(),
                    name, user, pass,
                    file: state.tempImg,
                    date: new Date().toLocaleDateString('id-ID')
                };

                state.data.unshift(newItem);
                localStorage.setItem('vault_v3_data', JSON.stringify(state.data));
                
                // Reset
                document.getElementById('in-name').value = "";
                document.getElementById('in-user').value = "";
                document.getElementById('in-pass').value = "";
                state.tempImg = "";
                addMod.classList.add('hidden');
                renderList();
                alert("Data Tersimpan!");
            };

            // 6. AI Smart Fill
            document.getElementById('ai-smart').onclick = async () => {
                const name = document.getElementById('in-name').value;
                if(!name) return alert("Isi nama layanan dulu!");
                document.getElementById('ai-smart').textContent = "Berpikir...";
                const res = await askAI(`Berikan satu kata deskripsi fungsi untuk ${na
